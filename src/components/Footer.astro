---
import { getISOWeek } from "@/utils";
import pkg from "../../package.json";

const version = pkg.version;

const now = new Date();
const week = getISOWeek(now);
const year = now.getFullYear();
---

<footer class="site-footer">
  <span class="chunk">
    © {year}
    <a href="https://goude.se">goude.se</a>
  </span>

  <span class="sep" aria-hidden="true">·</span>

  <span class="chunk">
    <a href="/" title="ISO week (Sweden: SS-ISO 8601-1)">Week {week}</a>
  </span>

  <span class="sep" aria-hidden="true">·</span>

  <span class="chunk">
    <a href="/">v{version}</a>
  </span>

  <div class="swatches">
    <span title="--palette-light-bg" style="background: var(--palette-light-bg)"
    ></span>
    <span title="--palette-light-fg" style="background: var(--palette-light-fg)"
    ></span>
    <span
      title="--palette-light-accent"
      style="background: var(--palette-light-accent)"></span>

    <span title="--palette-dark-bg" style="background: var(--palette-dark-bg)"
    ></span>
    <span title="--palette-dark-fg" style="background: var(--palette-dark-fg)"
    ></span>
    <span
      title="--palette-dark-accent"
      style="background: var(--palette-dark-accent)"></span>

    <span title="--accent-green" style="background: var(--accent-green)"></span>
    <span title="--accent-blue" style="background: var(--accent-blue)"></span>
    <span title="--accent-purple" style="background: var(--accent-purple)"
    ></span>
    <span title="--accent-yellow" style="background: var(--accent-yellow)"
    ></span>
    <span title="--accent-red" style="background: var(--accent-red)"></span>
  </div>
</footer>

<script is:inline>
  document.querySelectorAll(".swatches span").forEach((el) => {
    el.addEventListener("click", () => {
      const root = document.documentElement;
      const isDark = root.hasAttribute("data-theme-dark");

      root.removeAttribute("data-theme-dark");
      root.removeAttribute("data-theme-light");

      if (!isDark) {
        root.setAttribute("data-theme-dark", "");
      } else {
        root.setAttribute("data-theme-light", "");
      }
    });
  });
</script>

<style>
  .site-footer {
    font-family: var(--font-sans);
    font-size: 1rem;
    display: flex;
    flex-wrap: wrap;
    align-items: baseline;
    justify-content: center;
    gap: 0.35rem;
    padding: var(--space-lg) 0;
    margin-top: auto;
  }

  .chunk {
    display: inline-flex;
    align-items: baseline;
    gap: 0.35rem;
  }

  .sep {
    opacity: 0.35;
  }

  .swatches {
    width: 100%;
    display: flex;
    justify-content: center;
    gap: 0.35rem;
    margin-top: 0.5rem;
  }

  .swatches span {
    width: 0.9em;
    height: 0.9em;
    display: inline-block;
    border-radius: 2px;
    border: 1px solid var(--border);
    cursor: pointer;
  }
</style>
