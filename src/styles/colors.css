/* ==================== Color Palettes ==================== */

/* Base + Light (default source values) */
:root {
  /* Light source palette (immutable) */
  --palette-bg-light: #faf9f5;
  --palette-fg-light: #3d3d3a;
  --palette-accent-light: #cc7c5e;
  --palette-paper-light: #fbf8f4;

  /* Dark source palette (immutable) */
  --palette-bg-dark: #191612;        /* page background */
  --palette-paper-dark: #24201a;    /* paper / panels */
  --palette-surface-dark: #2c2621;  /* option backgrounds */
  --palette-rule-dark: #877053;     /* borders, rules */
  --palette-fg-dark: #e7e0d6;       /* body text */
  --palette-accent-dark: #cda77b;   /* headings, knobs */

  /* Active palette (theme-switchable) */
  --palette-bg: var(--palette-bg-light);
  --palette-fg: var(--palette-fg-light);
  --palette-accent: var(--palette-accent-light);
  --palette-paper: var(--palette-paper-light);

  /* Derived tokens */
  --bg: var(--palette-bg);
  --fg: var(--palette-fg);
  --accent: var(--palette-accent);
  --paper: var(--palette-paper);

  --fg-muted: color-mix(in srgb, var(--palette-fg) 58%, var(--palette-bg));
  --rule: color-mix(in srgb, var(--palette-fg) 14%, var(--palette-bg));
  --surface: color-mix(in srgb, var(--palette-fg) 4%, var(--palette-bg));

  /* Layout */
  --page-max: 900px;
  --page-pad: 24px;

  /* Typography */
  --font-serif: et-book, Palatino, "Palatino Linotype", Georgia, serif;
  --font-sans:
    "Source Sans Pro", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
    sans-serif;
  --font-code: "SF Mono", Monaco, "Cascadia Code", Consolas, monospace;

  --text-sm: 1rem;
  --text-base: 1.125rem;
  --text-lg: 1.25rem;
  --text-xl: 1.5rem;
  --text-2xl: 1.75rem;
  --text-3xl: 2.25rem;

  --space-sm: 0.75rem;
  --space-md: 1rem;
  --space-lg: 1.5rem;
  --space-xl: 2rem;
  --space-2xl: 3rem;

  --lh-body: 1.618;
  --lh-tight: 1.414;
}

/* ==================== Dark Theme ==================== */

@media (prefers-color-scheme: dark) {
  :root:not([data-theme-light]) {
    --palette-bg: var(--palette-bg-dark);
    --palette-fg: var(--palette-fg-dark);
    --palette-accent: var(--palette-accent-dark);
    --palette-paper: var(--palette-paper-dark);

    /* Override derived neutrals explicitly for dark */
    --surface: var(--palette-surface-dark);
    --rule: var(--palette-rule-dark);
  }
}

[data-theme-dark] {
  --palette-bg: var(--palette-bg-dark);
  --palette-fg: var(--palette-fg-dark);
  --palette-accent: var(--palette-accent-dark);
  --palette-paper: var(--palette-paper-dark);

  --surface: var(--palette-surface-dark);
  --rule: var(--palette-rule-dark);
}

/* ==================== Explicit Light ==================== */

[data-theme-light] {
  --palette-bg: var(--palette-bg-light);
  --palette-fg: var(--palette-fg-light);
  --palette-accent: var(--palette-accent-light);
  --palette-paper: var(--palette-paper-light);
}